<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Spatial Association Detector(SPADE)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spatial Association Detector(SPADE)</h1>



<div id="load-data-and-package" class="section level3">
<h3>Load data and package</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(gdverse)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>depression <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&#39;extdata/Depression.csv&#39;</span>,<span class="at">package =</span> <span class="st">&#39;gdverse&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">read_csv</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&#39;X&#39;</span>,<span class="st">&#39;Y&#39;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>depression</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="do">## Simple feature collection with 1072 features and 11 fields</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="do">## Geometry type: POINT</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="do">## Dimension:     XY</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="do">## Bounding box:  xmin: -83.1795 ymin: 32.11464 xmax: -78.6023 ymax: 35.17354</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="do">## Geodetic CRS:  WGS 84</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="do">## # A tibble: 1,072 × 12</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="do">##    Depression_prevelence PopulationDensity Population65 NoHealthInsurance</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="do">##  *                 &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="do">##  1                  23.1              61.5         22.5              7.98</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="do">##  2                  22.8              58.3         16.8             11.0 </span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="do">##  3                  23.2              35.9         24.5              9.31</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="do">##  4                  21.8              76.1         21.8             13.2 </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="do">##  5                  20.7              47.3         22.0             11   </span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="do">##  6                  21.3              32.5         19.2             13.0 </span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="do">##  7                  22                36.9         19.2             10.8 </span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="do">##  8                  21.2              61.5         15.9              8.57</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="do">##  9                  22.7              67.2         15.7             17.8 </span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="do">## 10                  20.6             254.          11.3             12.7 </span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="do">## # ℹ 1,062 more rows</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="do">## # ℹ 8 more variables: Neighbor_Disadvantage &lt;dbl&gt;, Beer &lt;dbl&gt;, MentalHealthPati &lt;dbl&gt;,</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="do">## #   NatureParks &lt;dbl&gt;, Casinos &lt;dbl&gt;, DrinkingPlaces &lt;dbl&gt;, X.HouseRent &lt;dbl&gt;,</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="do">## #   geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
</div>
<div id="spatial-autocorrelation-of-depression-prevelence" class="section level3">
<h3>Spatial Autocorrelation of Depression Prevelence</h3>
<p>here I use <code>geocomplexity</code> to calculate the global
<strong>Moran’s I</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456789</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>gmi <span class="ot">=</span> geocomplexity<span class="sc">::</span><span class="fu">moran_test</span>(depression)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>gmi</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## ***                 global spatial autocorrelation test</span></span></code></pre></div>
<table>
<colgroup>
<col width="28%" />
<col width="17%" />
<col width="15%" />
<col width="14%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">MoranI</th>
<th align="center">EI</th>
<th align="center">VarI</th>
<th align="center">zI</th>
<th align="center">pI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Depression_prevelence</td>
<td align="center">0.339557***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">19.06</td>
<td align="center">2.892e-81</td>
</tr>
<tr class="even">
<td align="center">PopulationDensity</td>
<td align="center">0.365364***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">20.5</td>
<td align="center">1.052e-93</td>
</tr>
<tr class="odd">
<td align="center">Population65</td>
<td align="center">0.180436***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.15</td>
<td align="center">1.641e-24</td>
</tr>
<tr class="even">
<td align="center">NoHealthInsurance</td>
<td align="center">0.0791199***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">4.48</td>
<td align="center">3.724e-06</td>
</tr>
<tr class="odd">
<td align="center">Neighbor_Disadvantage</td>
<td align="center">0.113811***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">6.422</td>
<td align="center">6.723e-11</td>
</tr>
<tr class="even">
<td align="center">Beer</td>
<td align="center">0.0902263***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.102</td>
<td align="center">1.68e-07</td>
</tr>
<tr class="odd">
<td align="center">MentalHealthPati</td>
<td align="center">0.19318***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.86</td>
<td align="center">8.534e-28</td>
</tr>
<tr class="even">
<td align="center">NatureParks</td>
<td align="center">0.0895589***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.065</td>
<td align="center">2.045e-07</td>
</tr>
<tr class="odd">
<td align="center">Casinos</td>
<td align="center">0.243212***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.66</td>
<td align="center">8.28e-43</td>
</tr>
<tr class="even">
<td align="center">DrinkingPlaces</td>
<td align="center">0.239054***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.43</td>
<td align="center">1.97e-41</td>
</tr>
<tr class="odd">
<td align="center">X.HouseRent</td>
<td align="center">0.141887***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">7.993</td>
<td align="center">6.562e-16</td>
</tr>
</tbody>
</table>
<p>The global Moran’I Index of Depression Prevelence is
<code>0.339557</code> and the P value is <code>2.892e-81</code>, which
shows that Depression Prevelence has a moderate level of positive
spatial autocorrelation in the global scale.</p>
</div>
<div id="opgd-modeling" class="section level3">
<h3>OPGD modeling</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>depression_opgd <span class="ot">=</span> <span class="fu">opgd</span>(Depression_prevelence <span class="sc">~</span> .,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                       <span class="at">data =</span> depression, <span class="at">cores =</span> <span class="dv">12</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>depression_opgd</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">##                 OPGD Model                  </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## ***          Factor Detector            </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## |       variable        | Q-statistic |   P-value    |</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">## |:---------------------:|:-----------:|:------------:|</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## | Neighbor_Disadvantage | 0.15931057  | 2.340391e-02 |</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">## |     Population65      | 0.11095945  | 9.999944e-01 |</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="do">## |   PopulationDensity   | 0.11065749  | 2.140000e-10 |</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="do">## |   NoHealthInsurance   | 0.08182401  | 8.340000e-10 |</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="do">## |    DrinkingPlaces     | 0.06639594  | 1.000000e+00 |</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="do">## |      NatureParks      | 0.06525932  | 1.000000e+00 |</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="do">## |      X.HouseRent      | 0.06111156  | 1.000000e+00 |</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="do">## |   MentalHealthPati    | 0.02532353  | 1.000000e+00 |</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="do">## |         Beer          | 0.02458667  | 1.000000e+00 |</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="do">## |        Casinos        | 0.01936872  | 4.363429e-01 |</span></span></code></pre></div>
<p><strong>You can access the detailed q statistics by
<code>depression_opgd$factor</code></strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>depression_opgd<span class="sc">$</span>factor</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## # A tibble: 10 × 3</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="do">##    variable              `Q-statistic` `P-value`</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">##  1 Neighbor_Disadvantage        0.159   2.34e- 2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">##  2 Population65                 0.111   1.00e+ 0</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">##  3 PopulationDensity            0.111   2.14e-10</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">##  4 NoHealthInsurance            0.0818  8.34e-10</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="do">##  5 DrinkingPlaces               0.0664  1.00e+ 0</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="do">##  6 NatureParks                  0.0653  1.00e+ 0</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">##  7 X.HouseRent                  0.0611  1   e+ 0</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="do">##  8 MentalHealthPati             0.0253  1   e+ 0</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="do">##  9 Beer                         0.0246  1   e+ 0</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="do">## 10 Casinos                      0.0194  4.36e- 1</span></span></code></pre></div>
</div>
<div id="spatial-weight-matrix" class="section level3">
<h3>Spatial Weight Matrix</h3>
<p><em>SPADE</em> explicitly considers the spatial variance by assigning
the weight of the influence based on spatial distribution and also
minimizes the influence of the number of levels on PD values by using
the multilevel discretization and considering information loss due to
discretization.</p>
<p>When response variable has a strong spatial dependence, maybe
<em>SPADE</em> is a best choice.</p>
<p>The biggest difference between SPADE and native GD and OPGD in actual
modeling is that SPADE requires a spatial weight matrix to calculate
spatial variance.</p>
<p>In <code>spade</code> function, when you not provide a spatial weight
matrix, it will use <strong>1st order inverse distance weight</strong>
by default, which can be created by
<code>inverse_distance_weight()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>coords <span class="ot">=</span> depression <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">st_coordinates</span>()</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>wt1 <span class="ot">=</span> <span class="fu">inverse_distance_weight</span>(coords[,<span class="dv">1</span>],coords[,<span class="dv">2</span>])</span></code></pre></div>
<p>You can also use gravity model weight by assigning the
<code>power</code> parameter in <code>inverse_distance_weight()</code>
function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>wt2 <span class="ot">=</span> <span class="fu">inverse_distance_weight</span>(coords[,<span class="dv">1</span>],coords[,<span class="dv">2</span>],<span class="at">power =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>I have also developed the <a href="https://stscl.github.io/sdsfun/">sdsfun</a> package to facilitate
the construction of spatial weight matrices, which requires an input of
an sf object.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>wt3 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">spdep_contiguity_swm</span>(depression, <span class="at">k =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>Or using a spatial weight matrix based on distance kernel
functions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>wt4 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">spdep_distance_swm</span>(depression, <span class="at">k =</span> <span class="dv">6</span>, <span class="at">kernel =</span> <span class="st">&#39;gaussian&#39;</span>)</span></code></pre></div>
<p>The test of <em>SPADE</em> model significance in <code>gdverse</code>
is achieved by randomization null hypothesis use a pseudo-p value, this
calculation is very time-consuming. Default <code>gdverse</code> sets
the <code>permutations</code> parameter to 0 and does not calculate the
pseudo-p value. If you want to calculate the pseudo-p value, specify the
<code>permutations</code> parameter to a number such as 99,999,9999,
etc.</p>
<p>In the following section we will execute <em>SPADE</em> model using
spatial weight matrix <code>wt1</code>.</p>
</div>
<div id="spade-modeling" class="section level3">
<h3>SPADE modeling</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>depression_spade <span class="ot">=</span> <span class="fu">spade</span>(Depression_prevelence <span class="sc">~</span> .,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                         <span class="at">data =</span> depression,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                         <span class="at">wt =</span> wt1, <span class="at">cores =</span> <span class="dv">12</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>depression_spade</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## ***         Spatial Association Detector         </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## |       variable        | Q-statistic |      P-value      |</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## |:---------------------:|:-----------:|:-----------------:|</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## |   PopulationDensity   | 0.22350789  | No Pseudo-P Value |</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">## |    DrinkingPlaces     | 0.18296329  | No Pseudo-P Value |</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">## | Neighbor_Disadvantage | 0.17159619  | No Pseudo-P Value |</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">## |        Casinos        | 0.16623609  | No Pseudo-P Value |</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="do">## |     Population65      | 0.15732787  | No Pseudo-P Value |</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="do">## |      NatureParks      | 0.13953548  | No Pseudo-P Value |</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">## |         Beer          | 0.10609591  | No Pseudo-P Value |</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="do">## |   NoHealthInsurance   | 0.07912873  | No Pseudo-P Value |</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">## |   MentalHealthPati    | 0.07778826  | No Pseudo-P Value |</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="do">## |      X.HouseRent      | 0.07250500  | No Pseudo-P Value |</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="fu">plot</span>(depression_spade, <span class="at">slicenum =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<p><strong>You can also access the detailed q statistics by
<code>depression_spade$factor</code></strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>depression_spade<span class="sc">$</span>factor</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="do">## # A tibble: 10 × 3</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="do">##    variable              `Q-statistic` `P-value`        </span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="do">##  1 PopulationDensity            0.224  No Pseudo-P Value</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="do">##  2 DrinkingPlaces               0.183  No Pseudo-P Value</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">##  3 Neighbor_Disadvantage        0.172  No Pseudo-P Value</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="do">##  4 Casinos                      0.166  No Pseudo-P Value</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="do">##  5 Population65                 0.157  No Pseudo-P Value</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="do">##  6 NatureParks                  0.140  No Pseudo-P Value</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="do">##  7 Beer                         0.106  No Pseudo-P Value</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="do">##  8 NoHealthInsurance            0.0791 No Pseudo-P Value</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="do">##  9 MentalHealthPati             0.0778 No Pseudo-P Value</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="do">## 10 X.HouseRent                  0.0725 No Pseudo-P Value</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
