<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Spatial Association Detector(SPADE)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spatial Association Detector(SPADE)</h1>



<div id="load-data-and-package" class="section level3">
<h3>Load data and package</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">## ── Attaching core tidyverse packages ─────────────────────────────────────── tidyverse 2.0.0 ──</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">## ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">## ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="do">## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="do">## ✔ purrr     1.0.2</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="do">## ── Conflicts ───────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="do">## ✖ dplyr::filter() masks stats::filter()</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="do">## ✖ dplyr::lag()    masks stats::lag()</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="do">## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">library</span>(gdverse)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="do">## gdverse 1.3.2</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="do">## See itmsa package for entropy-based spatial association measures.</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>depression <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&#39;extdata/Depression.csv&#39;</span>,<span class="at">package =</span> <span class="st">&#39;gdverse&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">read_csv</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&#39;X&#39;</span>,<span class="st">&#39;Y&#39;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="do">## Rows: 1072 Columns: 13</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="do">## ── Column specification ───────────────────────────────────────────────────────────────────────</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="do">## Delimiter: &quot;,&quot;</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="do">## dbl (13): X, Y, Depression_prevelence, PopulationDensity, Population65, NoHealthInsurance, ...</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="do">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="do">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>depression</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="do">## Simple feature collection with 1072 features and 11 fields</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="do">## Geometry type: POINT</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="do">## Dimension:     XY</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="do">## Bounding box:  xmin: -83.1795 ymin: 32.11464 xmax: -78.6023 ymax: 35.17354</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="do">## Geodetic CRS:  WGS 84</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="do">## # A tibble: 1,072 × 12</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="do">##    Depression_prevelence PopulationDensity Population65 NoHealthInsurance Neighbor_Disadvantage</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="do">##  *                 &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;             &lt;dbl&gt;                 &lt;dbl&gt;</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="do">##  1                  23.1              61.5         22.5              7.98               -0.0525</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="do">##  2                  22.8              58.3         16.8             11.0                -0.254 </span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="do">##  3                  23.2              35.9         24.5              9.31               -0.0540</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="do">##  4                  21.8              76.1         21.8             13.2                 0.0731</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="do">##  5                  20.7              47.3         22.0             11                   0.763 </span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="do">##  6                  21.3              32.5         19.2             13.0                 0.422 </span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="do">##  7                  22                36.9         19.2             10.8                 0.113 </span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="do">##  8                  21.2              61.5         15.9              8.57               -0.154 </span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="do">##  9                  22.7              67.2         15.7             17.8                -0.320 </span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="do">## 10                  20.6             254.          11.3             12.7                 0.457 </span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="do">## # ℹ 1,062 more rows</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="do">## # ℹ 7 more variables: Beer &lt;dbl&gt;, MentalHealthPati &lt;dbl&gt;, NatureParks &lt;dbl&gt;, Casinos &lt;dbl&gt;,</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="do">## #   DrinkingPlaces &lt;dbl&gt;, X.HouseRent &lt;dbl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
</div>
<div id="spatial-autocorrelation-of-depression-prevelence" class="section level3">
<h3>Spatial Autocorrelation of Depression Prevelence</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456789</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>gmi <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">moran_test</span>(depression)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>gmi</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## ***                 global moran test</span></span></code></pre></div>
<table>
<colgroup>
<col width="28%" />
<col width="17%" />
<col width="15%" />
<col width="14%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">MoranI</th>
<th align="center">EI</th>
<th align="center">VarI</th>
<th align="center">zI</th>
<th align="center">pI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Depression_prevelence</td>
<td align="center">0.339557***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">19.06</td>
<td align="center">2.892e-81</td>
</tr>
<tr class="even">
<td align="center">PopulationDensity</td>
<td align="center">0.365364***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">20.5</td>
<td align="center">1.052e-93</td>
</tr>
<tr class="odd">
<td align="center">Population65</td>
<td align="center">0.180436***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.15</td>
<td align="center">1.641e-24</td>
</tr>
<tr class="even">
<td align="center">NoHealthInsurance</td>
<td align="center">0.0791199***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">4.48</td>
<td align="center">3.724e-06</td>
</tr>
<tr class="odd">
<td align="center">Neighbor_Disadvantage</td>
<td align="center">0.113811***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">6.422</td>
<td align="center">6.723e-11</td>
</tr>
<tr class="even">
<td align="center">Beer</td>
<td align="center">0.0902263***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.102</td>
<td align="center">1.68e-07</td>
</tr>
<tr class="odd">
<td align="center">MentalHealthPati</td>
<td align="center">0.19318***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.86</td>
<td align="center">8.534e-28</td>
</tr>
<tr class="even">
<td align="center">NatureParks</td>
<td align="center">0.0895589***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.065</td>
<td align="center">2.045e-07</td>
</tr>
<tr class="odd">
<td align="center">Casinos</td>
<td align="center">0.243212***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.66</td>
<td align="center">8.28e-43</td>
</tr>
<tr class="even">
<td align="center">DrinkingPlaces</td>
<td align="center">0.239054***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.43</td>
<td align="center">1.97e-41</td>
</tr>
<tr class="odd">
<td align="center">X.HouseRent</td>
<td align="center">0.141887***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">7.993</td>
<td align="center">6.562e-16</td>
</tr>
</tbody>
</table>
<p>The global Moran’I Index of Depression Prevelence is
<code>0.339557</code> and the P value is <code>2.892e-81</code>, which
shows that Depression Prevelence has a moderate level of positive
spatial autocorrelation in the global scale.</p>
</div>
<div id="opgd-modeling" class="section level3">
<h3>OPGD modeling</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>depression_opgd <span class="ot">=</span> <span class="fu">opgd</span>(Depression_prevelence <span class="sc">~</span> .,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                       <span class="at">data =</span> depression, <span class="at">cores =</span> <span class="dv">12</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>depression_opgd</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">## ***   Optimal Parameters-based Geographical Detector     </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">##                 Factor Detector            </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## |       variable        | Q-statistic |   P-value    |</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">## |:---------------------:|:-----------:|:------------:|</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## | Neighbor_Disadvantage | 0.13979930  | 4.960000e-10 |</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">## |   PopulationDensity   | 0.09186679  | 2.328052e-01 |</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="do">## |     Population65      | 0.08956911  | 1.000000e+00 |</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="do">## |   NoHealthInsurance   | 0.06779068  | 6.479536e-01 |</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="do">## |      NatureParks      | 0.05963161  | 1.000000e+00 |</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="do">## |    DrinkingPlaces     | 0.05411512  | 1.000000e+00 |</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="do">## |      X.HouseRent      | 0.03439383  | 1.000000e+00 |</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="do">## |         Beer          | 0.01410217  | 1.000000e+00 |</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="do">## |   MentalHealthPati    | 0.01295799  | 1.000000e+00 |</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="do">## |        Casinos        | 0.01207694  | 1.000000e+00 |</span></span></code></pre></div>
<p><strong>You can access the detailed q statistics by
<code>depression_opgd$factor</code></strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>depression_opgd<span class="sc">$</span>factor</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## # A tibble: 10 × 3</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="do">##    variable              `Q-statistic` `P-value`</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">##  1 Neighbor_Disadvantage        0.140   4.96e-10</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">##  2 PopulationDensity            0.0919  2.33e- 1</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">##  3 Population65                 0.0896  1.00e+ 0</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">##  4 NoHealthInsurance            0.0678  6.48e- 1</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="do">##  5 NatureParks                  0.0596  1.00e+ 0</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="do">##  6 DrinkingPlaces               0.0541  1.00e+ 0</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">##  7 X.HouseRent                  0.0344  1.00e+ 0</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="do">##  8 Beer                         0.0141  1   e+ 0</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="do">##  9 MentalHealthPati             0.0130  1.00e+ 0</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="do">## 10 Casinos                      0.0121  1   e+ 0</span></span></code></pre></div>
</div>
<div id="spatial-weight-matrix" class="section level3">
<h3>Spatial Weight Matrix</h3>
<p><em>SPADE</em> explicitly considers the spatial variance by assigning
the weight of the influence based on spatial distribution and also
minimizes the influence of the number of levels on PD values by using
the multilevel discretization and considering information loss due to
discretization.</p>
<p>When response variable has a strong spatial dependence, maybe
<em>SPADE</em> is a best choice.</p>
<p>The biggest difference between SPADE and native GD and OPGD in actual
modeling is that SPADE requires a spatial weight matrix to calculate
spatial variance.</p>
<p>I have also developed the <a href="https://stscl.github.io/sdsfun/">sdsfun</a> package to facilitate
the construction of spatial weight matrices, which requires an input of
an sf object.</p>
<p>In <code>spade</code> function, when you not provide a spatial weight
matrix, it will use <strong>1st order inverse distance weight</strong>
by default, which can be created by
<code>sdsfun::inverse_distance_swm()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>wt1 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">inverse_distance_swm</span>(depression)</span></code></pre></div>
<p>You can also use gravity model weight by assigning the
<code>power</code> parameter in
<code>sdsfun::inverse_distance_swm()</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>wt2 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">inverse_distance_swm</span>(depression,<span class="at">power =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Or using a spatial weight matrix based on geospatial contiguity.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>wt3 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">spdep_contiguity_swm</span>(depression, <span class="at">k =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>Or using a spatial weight matrix based on distance kernel
functions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>wt4 <span class="ot">=</span> sdsfun<span class="sc">::</span><span class="fu">spdep_distance_swm</span>(depression, <span class="at">k =</span> <span class="dv">6</span>, <span class="at">kernel =</span> <span class="st">&#39;gaussian&#39;</span>)</span></code></pre></div>
<p>The test of <em>SPADE</em> model significance in <code>gdverse</code>
is achieved by randomization null hypothesis use a pseudo-p value, this
calculation is very time-consuming. Default <code>gdverse</code> sets
the <code>permutations</code> parameter to 0 and does not calculate the
pseudo-p value. If you want to calculate the pseudo-p value, specify the
<code>permutations</code> parameter to a number such as 99,999,9999,
etc.</p>
<p>In the following section we will execute <em>SPADE</em> model using
spatial weight matrix <code>wt1</code>.</p>
</div>
<div id="spade-modeling" class="section level3">
<h3>SPADE modeling</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>depression_spade <span class="ot">=</span> <span class="fu">spade</span>(Depression_prevelence <span class="sc">~</span> .,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                         <span class="at">data =</span> depression,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                         <span class="at">wt =</span> wt1, <span class="at">cores =</span> <span class="dv">12</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>depression_spade</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## ***         Spatial Association Detector         </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## |       variable        | Q-statistic |      P-value      |</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## |:---------------------:|:-----------:|:-----------------:|</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## |   PopulationDensity   | 0.21532238  | No Pseudo-P Value |</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">## |    DrinkingPlaces     | 0.18564821  | No Pseudo-P Value |</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">## |        Casinos        | 0.17438646  | No Pseudo-P Value |</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">## | Neighbor_Disadvantage | 0.17235706  | No Pseudo-P Value |</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="do">## |      NatureParks      | 0.17019859  | No Pseudo-P Value |</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="do">## |     Population65      | 0.15592529  | No Pseudo-P Value |</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">## |         Beer          | 0.09506759  | No Pseudo-P Value |</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="do">## |   MentalHealthPati    | 0.07956353  | No Pseudo-P Value |</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">## |   NoHealthInsurance   | 0.07753293  | No Pseudo-P Value |</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="do">## |      X.HouseRent      | 0.05621546  | No Pseudo-P Value |</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="fu">plot</span>(depression_spade, <span class="at">slicenum =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /></p>
<p><strong>You can also access the detailed q statistics by
<code>depression_spade$factor</code></strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>depression_spade<span class="sc">$</span>factor</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="do">## # A tibble: 10 × 3</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="do">##    variable              `Q-statistic` `P-value`        </span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="do">##  1 PopulationDensity            0.215  No Pseudo-P Value</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="do">##  2 DrinkingPlaces               0.186  No Pseudo-P Value</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">##  3 Casinos                      0.174  No Pseudo-P Value</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="do">##  4 Neighbor_Disadvantage        0.172  No Pseudo-P Value</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="do">##  5 NatureParks                  0.170  No Pseudo-P Value</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="do">##  6 Population65                 0.156  No Pseudo-P Value</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="do">##  7 Beer                         0.0951 No Pseudo-P Value</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="do">##  8 MentalHealthPati             0.0796 No Pseudo-P Value</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="do">##  9 NoHealthInsurance            0.0775 No Pseudo-P Value</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="do">## 10 X.HouseRent                  0.0562 No Pseudo-P Value</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
